>概念组织：实物组织。建筑完整生命周期里的量价分析查询系统。(解决的问题：给定一栋楼模型-分析计算造价(从挖土到装修完成))(支持动态调整材料量-重新计算/而不用重新改图-建模)(使用的思路：划分+累计。周期划分、施工段划分、清单划分、定额划分(确定最小工程量)、工料机划分(确定最小计价事务))
	>区域：
		>标段：
			>项目：一个单体建筑。这个单体建筑的建模图数据=GTJ文件。这个单体建筑的算量算价数据=计价文件。
				>阶段：土方工程-->基础工程-->主体结构-->二次结构-->装饰装修-->(门窗/给排水/通信/电气/煤气)
					>施工段: 单体建筑 施工时 按 空间范围 划分的 若干个 独立施工区域(一个施工队承接一个施工段)。
						>模型文件中的概念：
							>构件：一个施工段 包含的 具体施工内容，若干个建筑组件(柱/墙/梁/板)(部分)。
								>图元：该构件的每个实例 为 一个 图元。某施工段下的一个构件类型下的构件的图元可能有多个，且每个图元的各个量相加=构件的同量的值。
							>材料：构件类型下所有构件的材料
								>钢筋： 
								>混凝土： 
						>计价文件中的概念：
							>清单：一个清单代表(某个工程量下的, 如体积清单/高度清单) 一个工作任务(往往是对一个构件的施工)。一个施工段有多个清单。(基本属性包括：工程量、工程量单位)  多个清单：往往是一个复合物才有(如装饰装修阶段：对墙面(构件)的 两个清单 ：：块料：墙面加白水泥 加 瓷砖，如抹灰-水泥)(墙的体积-混凝土,墙的面积-抹灰，墙的长度-瓷砖)
								>项：一个项 代表 所属清单 的  一个 方案。多个项代表多种方案。
									>定额：(命名由列而来)一个定额代表 使用A项(方案) 来实现 B清单 的一个步骤(一个组成部分的清单度量下的情况, 如 柱/墙/梁/板中一个的清单度量下的情况)。A项方案 包含 多个步骤，每个步骤 用一个定额 描述。 (基本属性包括：工程量、工程量单位、含量)(含量= 完成 一个所属清单工程量 所需要的 这个定额的 该工程量单位 下的 工程量)(工程量=所属清单的总工程量*含量)
										>人：一个定额 选择 A方式 来实现 所需要的 人力 资源量。(基本属性包括：含量、单位、数量、不含税市场价、综合总价) 含量= 一个人 完成 单位定额工作量 所需的 天数(劳动时间单位)；是不变的。单位=劳动时间单位=天数。数量= 所属定额的工程量 * 含量 。不含税市场价=单位量 
										>材：
										>机：
										---结论1：一个构件可能属于多个量清单下。
										---结论2：一个量清单的目的在 表达 工程量(该任务的总工程量) 的含义。
										---结论3：一个维度量下的清单项 有 编码：010503002003 。定额有编码：5-1-19。 
										---结论4：一个量定额的目的在 表达 含量(满足一个所属清单量 所需要的 该定额量) + 工程量(所属清单项下的 定额总工程量) 的含义。 
										---结论5：补项 和 补子目 就像 清单项 和  定额。
										---结论6：一个人力项的目的 在 表达 含量(完成一个定额工程量下所需的人力方面的 工作量)+(工作量)单位 + 工程量(总工作量) 的 含义。
										---结论7：清单项 和 定额 的关系 就像 产品(火药) 和 材料(木炭/硫磺/硝石) 的关系。清单工程量=所需(设计的)火药总量。 定额工程量=一单位火药所需的木炭量*火药总量。。。这个量可以是质量、体积。
										---结论8：定额 和 人材机 的关系 就像 生产 木炭 所需的 人力工作量 + 机器工作量 + 材料量 的关系。单位木炭所需的  人力工作量 + 机器量 + 材料量 分别是 人力 、机器、材料 的含量。总木炭量 所需的 人材机分别总量自然可算。单位工作量所需费用(不含税市场价)也知，则人材机分别的总费用 就知。 
										---结论9：一个构件有n个属性，则该构件可能属于>=n个清单(因为一个维度下也可有多个清单项)(项k1个/补项k2个)。
										---结论10：一个施工段下的一个工程量维度(m3)下可以有多个清单项(项/补项)，且都关联了同一个构件。
										---结论11：所有的计算都基于 一个清单项的 工程量。一个清单项的工程量 来自 一个构件的全部图元的工程量 或者 来自 一个构件的 部分图元的工程量(如对于补项)。(因为清单工程量，可以计算定额的工程量，从而计算人材机的工程量)
										---结论12：一个清单项 可能关联 多个构件。如一个 补项 就可以关联 多个构件。 
										---：二者 通过 第一级工程量关联起来
										---：施工段 是 施工阶段才有的概念。建模和计价阶段没有。
											>有不同的施工队参与：导致了楼层/单体的施工段的划分。施工段可能会拆分图元/构件。施工段的划分：为用户定义的(部位划分定义)而为计价文件划分解析c++任务所使用。
												>建模文件需要划分-来明确工程量，计价文件需要划分-来明确工料机费用。
	-例子：A区域下C标段的D项目的E施工段的F清单的G定额的人材机。		
	
			
>名词解释:
	>GTJ 文件： 单体建筑的建模文件。G:广联达；TJ：土建。
	>igms 文件： 从 一个 GTJ 文件 导出的 一个 模型文件(汇总计算的结果,包含了划分的施工段)(上传到了基础数据平台)。可以导出多个 模型文件。 ？？是个什么数据文件？--纯粹的空间物理数据文件。
	>GBQ 文件： 基于一个GTJ文件 导入 而建立的 一个计价文件/量表文件/预算文件。
	>部位量表：施工段的 构件列表。
	>GFY 文件： 翻样建模出的建模文件--类似GTJ文件。同理，也可以 导出 多个模型文件--- json文件。
	>施工阶段：建筑的不同时期 有不同的施工类型。土方工程、基础工程、主体结构、二次结构、装饰装修。
	>部位划分：单体-->施工阶段-->楼层-->施工段 。。。例子：一个单体 在不同的施工阶段 的不同楼层 有多个施工段， 一个施工段 下需要对 多个类型的多个 构件施工；
	>工程量：体积/截面高度/...
	>数据库里的的：edo--图元, element--构件
	
	--结论1：一个GTJ文件 可以 映射 多个计价文件；表示的含义 为：
	--结论2：一个模型文件 可以 映射 多个计价文件：表示的含义 为：
	--结论3：一个清单项 可以 映射 一个gtj构件 映射 多个gtj图元：自然可以 一个清单项  多个gtj构件 多个gtj图元
	--结论4：一个图元 可以 被 7个 清单项关联。同一个构件的两个 图元 可以分别 关联 到 7个清单项 和 9个清单项。
	
	>材料：只有2种：钢筋(kg) / 混凝土(m^3)(TJ:体积)
>产品目的：
	>建模模型 和 计价文件 的关联：建模模型导出的 某个igms文件 和 某个计价文件的关联。 
		>关联方式：建模模型GBQ 和 计价文件：
			>条件：先查找一个项目下的所有igms模型文件，而数据库事先保存了projectid-bid-model_file_id的关联。从而可以用bid_id可以找到 映射的所有 模型文件。
		>目前方式：某个 工程 关联 igms模型。(工程的下一级：施工阶段--楼层--施工段)	
		>需求方式： 工程 仍 关联 igms模型。楼层-施工段 则关联部位。
			>关联部位：
	
>模块功能总结：
	>部位量表：查看工程量。。本质为一个耗材管理。
		>项目-施工-部位的构件类型：用locationId从pbs获取所有的构件类型。
		>部位-构件类型的构件工程量：pbs服务中获取, 先获取该部位-构件类型的所有 模型构件id:elementId再到 模型构件(elementId)本身。材料列表也是 这样 查找出来的。
		>工程-部位-模型构件id的清单-定额-人材机：使用 elementId 。 (正是之前量表文件的关联模型时，将 模型文件和计价文件-项目关联,从而模型文件的构件(可能多个) 和 计价文件的 构件  通过 两种构件都有的 模型文件的uniqueKey: originId/gtj构件id (正则匹配<elementOriginId>111123786657882)  关联了起来。)
			>图元列表的获取：也是 elementId + locationid+ projectMaterialId 从 pbs获取。elementId=模型构件id 
			>计价文件关联的清单/定额：通过 gtc_item_model_element_quantity 表 获取到 定额子目id, 从而进一步可以查 定额实体 和 清单实体 和 人材机。
		>构件明细：
			>构件工程量：模型上的工程量。如 A构件的体积是 7.3006 m3 。 一个构件往往 就是一个清单项 的工程量，甚至多个清单项(同单位)。 构件  是 比较大 的一个概念。
				>各个定额工程量：实际各项具体耗材的工程量：(同单位)。每项耗材(因为有自己的规格为单位) 所需的人材机 不同。
					>人材机工作量：需要人工耗时多少 + 机器耗时多少 + 材料消耗 多少(量/时间)。			
	>量表文件：上传计价文件，解析计价文件。(计价中的清单/模型中的构件)
		>关联模型：计价文件解析后，可能发现它是 对多个项目的计价的结果；每个项目的计价 是想看的，但是一个项目关联k个igms文件(但igms和计价文件没有直接关联和数据依赖关系/时间先后)(和标段无关，即标段不作为过滤条件)
			>项目手动关联igms文件的结果：1.除了增加一条关联关系(project-bidnode-model_file_id)，2.还有：删除 该项目该标段下 旧的 所有的图元/构件。3.查找新选择的模型文件(远程其他api)(+项目匹配到的)的所有构件, 按楼层分组；对于 A楼层上的所有 组件列表 ， 进一步按originId(gtj构件id)分组，查找所属计价文件在该项目-标段下的所有 构件(即gbq解析后存储在数据库中的)，对每个计价文件找到的构件，用gtjElementId从而找到 模型文件的所有对应的 构件列表，直接入库 到 模型文件的构件表(gtc_item_model_element_quantity) 即可。
				>同理：查找计价文件在该项目-标段 下的所有定额 (专门表gtc_norm_item_element_quantity)(也是解析gbq时加入的)，遍历每一条，对每个gtj构件id, 查找 新模型中 匹配到 这个 gtj构件id的所有 模型构件，直接加到对应表里(gtc_item_model_element_quantity)		
			
		
				